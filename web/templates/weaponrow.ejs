<tr>
<td><% if (final == 1) { %>
      <strong>*</strong>
    <% } else { %>
      &nbsp;
    <% } %>
</td>
<td>
  <a href="weaponplanner.html?weapon=<%= encodeURIComponent(name) %>"
        ><%= name %></a>
</td>
<td><%= wtype %></td>
<td><%= attack %></td>
<td style="text-align:right"><% if (affinity) { %><%= affinity %>%<% } %></td>
<td>
<% if (awaken) { %>
  [<%= awaken_attack %> <%= awaken %>]
<% } else if (element) { %>
  (<%= element_attack %> <%= element %>
  <% if (element_2) { %>
    , <%= element_2_attack %> <%= element_2 %>
  <% } %>)
<% } %>
</td>
<td><%= Array(num_slots + 1).join("o")
     %><%= Array(3 - num_slots + 1).join("-") %></td>
<td>
<div class="sharpness-bar" title="<%= sharpness_title %>">
<span style="width:<%= sharpness[0] %>px" class="red"></span>
<span style="width:<%= sharpness[1] %>px" class="orange"></span>
<span style="width:<%= sharpness[2] %>px" class="yellow"></span>
<span style="width:<%= sharpness[3] %>px" class="green"></span>
<span style="width:<%= sharpness[4] %>px" class="blue"></span>
<span style="width:<%= sharpness[5] %>px" class="white"></span>
<span style="width:<%= sharpness[6] %>px" class="purple"></span>
</div>
<div class="sharpness-bar" title="<%= sharpness_plus_title %>">
<span style="width:<%= sharpness_plus[0] %>px" class="red"></span>
<span style="width:<%= sharpness_plus[1] %>px" class="orange"></span>
<span style="width:<%= sharpness_plus[2] %>px" class="yellow"></span>
<span style="width:<%= sharpness_plus[3] %>px" class="green"></span>
<span style="width:<%= sharpness_plus[4] %>px" class="blue"></span>
<span style="width:<%= sharpness_plus[5] %>px" class="white"></span>
<span style="width:<%= sharpness_plus[6] %>px" class="purple"></span>
</div>
</td>
<td><%= sharpness_title %></td>
<td>(<%= sharpness_plus_title %>)</td>
</tr>
